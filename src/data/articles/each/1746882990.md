<!-- META
{"title":"Evolving Random Forest for Preference Learning","link":"https://link.springer.com/chapter/10.1007/978-3-319-16549-3_26","media":"academic","tags":["geneticalgorithm","randomforest","preference","preferencelearning"],"short":{"en":"Earned Accurate Preference Prediction by Evolving Random Forests via Grammatical Evolution","ja":"文法進化によるランダムフォレスト進化で高精度な選好予測を実現"},"importance":5,"hasPage":true,"createdAt":1746882990.454,"updatedAt":1746882990.454}
META -->

# Evolving Random Forest for Preference Learning

進化的ランダムフォレストによるペアワイズ選好学習

_文法進化によるランダムフォレスト進化で高精度な選好予測を実現_

## 概要

本論文は、進化的手法とランダムフォレスト（RF）を組み合わせた新しいペアワイズ選好学習手法を提案します。特に、ペアワイズ比較として収集されたユーザー選好データ（アフェクティブ・コンピューティングやユーザー体験研究で一般的）を対象とし、文法進化（GE）を用いてランダムフォレストの各決定木構造を進化的に最適化します。提案手法は、Super Mario Brosのプレイセッション（自己申告による「没入」「フラストレーション」「チャレンジ」の感情状態付き）を用いて検証されました。

## 手法

**背景と課題**

- 従来のペアワイズ選好モデリング手法は、グローバルなランキング関数の学習を目指すものが多く、ペアワイズデータの非推移性や関係性のため精度が低下しやすいという課題があります。
- 先行研究のNeuroevolutionary Preference Learning（NPL）は高精度ですが、解釈性に乏しい問題がありました。
- 本研究は、ペアワイズ選好学習に特化した、解釈性の高いランダムフォレスト進化手法を提案します。

**ランダムフォレストの適用**

- ランダムフォレストは複数の決定木をアンサンブル化し、各木はデータ・特徴量のランダムサブセットで学習されます。
- ペアワイズ選好学習では、各ペアにおいて「好ましい方」のインスタンスにモデル出力が高くなるように訓練します（回帰として扱う）。

**文法進化（GE）**

- GEは、線形ゲノムを文脈自由文法（Backus-Naur形式）で決定木構造にマッピングする進化的アルゴリズムです。
- 文法は内部ノードの分岐条件やリーフの値範囲などを定義します。

**ランダムフォレストの進化的最適化**

- 文法に従いランダムな木を初期集団として生成し、各木をペアワイズデータで評価します。
- 適合度は「正しく順序付けできたペア数」で評価。
- トーナメント選択・ルーレット選択、クロスオーバー、突然変異などの進化的操作を繰り返し、最良の木をフォレストとして選抜。
- 指定世代まで進化を繰り返し、最終的なモデルをテストセットで評価します。

**設計文法例（抜粋）**

```bnf
<Tree> := <Internal_Node>
<Internal_Node> := <Condition> <Child_Node> <Child_Node>
<Condition> := <Feature> <Threshold>
<Feature> := feature1 | feature2 | ...
<Leaf> := <Regression_value>
<Threshold> := [0,1]
<Regression_value> := [0,100]
```

## 実験設定

- **データセット**: 1560プレイセッション（780ペア）、自己申告による感情状態付き（没入・フラストレーション・チャレンジ）。
- **特徴量**: 30種のゲームプレイ・コンテンツ特徴量。
- **分割**: 訓練70%、検証15%、テスト15%。
- **進化パラメータ**: 50回実行、100世代、集団サイズ3000、トーナメントサイズ30、突然変異確率0.3、交叉確率0.5。
- **ソフトウェア**: GEVA（Grammatical Evolution in Java）。

## 結果

**木の本数の影響**

- 森の木の本数を増やすと精度が向上し、100本で頭打ちとなる傾向。
- 60本以上で有意に高精度となり、以降は大きな差がないため、100本構成を標準としました。

**木の深さの影響**

- 深さ10と20で比較したが、精度に有意差なし。
- 解釈性・計算効率から深さ10を推奨。

**性能比較**

| 感情状態      | RF平均精度 | RF最高精度 | NPL平均精度 | NPL最高精度 |
|---------------|------------|------------|--------------|-------------|
| 没入          | 63.01%     | 73.03%     | 67.18%       | 73.50%      |
| フラストレーション | 77.68%     | 86.08%     | 76.50%       | 83.00%      |
| チャレンジ    | 72.66%     | 85.11%     | 74.03%       | 79.10%      |

- フラストレーション・チャレンジの予測でNPLを上回り、没入では同等の結果。
- フラストレーションが最も予測しやすく、没入が最も難しい。

**表現力・特徴量重要度**

- 単一木モデルは解釈性が高いが精度が低く、100木のフォレストが最良のトレードオフ。
- 特徴量重要度分析では、コンテンツ特徴や死亡関連特徴（死亡回数・死亡理由）がフラストレーション・チャレンジ予測に有効。
- 没入予測には、より少数の特徴量（ゲーム内容・プレイ行動の一部）が寄与。

## 適用可能性と有効条件

- 本手法は、ペアワイズ選好データとリッチな特徴量が揃った大規模データセットで検証済みです。
- 適用が有効なのは以下の条件下です：
  - ペアワイズ選好データが利用可能な場合
  - モデルの解釈性・表現力が求められる場合
  - 進化的計算資源が利用可能な場合

## 結論

- 本研究は、ペアワイズ選好学習に特化した進化的ランダムフォレスト手法を世界で初めて提案しました。
- 提案手法は高精度かつ解釈性も確保し、既存の最先端手法（NPL）を上回る場合もありました。
- 今後は、さらなる解釈性向上（木数削減やルール抽出）や、ユーザー適応型コンテンツ生成への応用が期待されます。

**まとめ：文法進化によるランダムフォレスト進化は、ペアワイズ選好データから高精度かつ解釈しやすいモデルを構築できる有力な枠組みであり、ゲーム体験のモデリングなど幅広い応用が可能です。**

---

**本手法は、十分なペアワイズ選好データと特徴量が揃い、進化的計算リソースが利用できる環境で有効です。**

Sources
[1] 978-3-319-16549-3_26.pdf https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/1274205/bd7166fd-ac22-474e-af87-321c3a526e42/978-3-319-16549-3_26.pdf
