<!-- META
{"title":"Collaborating Action by Action: A Multi-agent LLM Framework for Embodied Reasoning","link":"https://mindcraft-minecollab.github.io/index.html","media":"academic","tags":["gameai","minecraft","characterai"],"short":{"en":"Earned that current LLM agents are ill-optimized for multi-agent collaboration, especially in embodied scenarios, highlighted by a performance drop of up to 15% when required to communicate detailed plans by introducing MINDcraft, a multi-agent LLM platform for Minecraft, and MineCollab, a benchmark for embodied collaborative reasoning","ja":"Minecraft環境で現在のLLMエージェントは、特に身体性を伴うシナリオでの多エージェント協調に最適化されておらず、詳細な計画の伝達を要求されると性能が最大15%低下するという知見を得た論文"},"importance":2,"hasPage":true,"createdAt":1753095713.091,"updatedAt":1753095713.091}
META -->

# Collaborating Action by Action: A Multi-agent LLM Framework for Embodied Reasoning
- Earned that current LLM agents are ill-optimized for multi-agent collaboration, especially in embodied scenarios, highlighted by a performance drop of up to 15% when required to communicate detailed plans by introducing MINDcraft, a multi-agent LLM platform for Minecraft, and MineCollab, a benchmark for embodied collaborative reasoning
- Minecraft環境で複数のLLMエージェントを協調させるプラットフォーム「MINDcraft」と、その評価ベンチマーク「MineCollab」を構築し、現在のLLMエージェントは、特に身体性を伴うシナリオでの多エージェント協調に最適化されておらず、詳細な計画の伝達を要求されると性能が最大15%低下するという知見を得た論文

## 著者
- Isadora White
- Kolby Nottingham
- Ayush Maniar
- Max Robinson
- Hansen Lillemark
- Mehul Maheshwari
- Lianhui Qin
- Prithviraj Ammanabrolu

## 概要
本研究は、大規模言語モデル（LLM）が、日常の様々な場面で不可欠な「協調」を、どのようにして適応的に行い、複雑で身体性を伴う推論タスクを解決できるかを探求する。 [6, 7] この目的のために、研究チームは2つの主要な貢献を果たした。一つは、オープンワールドゲーム「Minecraft」内でLLMエージェントがキャラクターを制御できるように設計された、拡張性の高いプラットフォーム「**MINDcraft**」の開発である。 [8] もう一つは、身体性と協調的推論の様々な側面をテストするために作られたベンチマーク「**MineCollab**」の導入である。 [9] MineCollabは、料理、クラフト、建設という3つの実践的なタスクドメインで構成される。 [44, 45, 46] 研究チームは、このプラットフォーム上で最先端のLLMエージェントの性能を体系的に評価する実験を行った。その結果、現在のエージェントにとって協調を効果的に行う上での最大の障害（ボトルネック）は、**効率的な自然言語によるコミュニケーション**であることが判明した。 [10] 具体的には、エージェントがタスク完了のための詳細な計画を互いに伝え合うことを要求されると、タスクの成功率が最大で15%も低下した。 [10] この結果から、既存のLLMエージェントは多エージェントでの協調、特に身体性を伴う現実世界に近いシナリオには最適化されておらず、その能力向上のためには、現在主流であるin-context学習や模倣学習といった手法を超える、より高度なアプローチが必要であると結論付けている。 [11]

## 背景
### 研究の意義
現実世界のタスクの多くは、単独ではなくチームでの協調的な問題解決を必要とする。 [13] AIエージェントは、こうした人間の共同作業をさらに強化する可能性を秘めている。 [13] これまでのAI開発は、特定タスクにおいて人間レベルの精度を達成・超越することに主眼が置かれ、他のエージェントの行動を模倣することで学習するモデルが多かった。 [14] しかしこのアプローチは、新たなAIを既存のエージェントの「代替品」と見なすものであり、チーム全体の潜在能力を損なう可能性がある。 [15]
本研究では、他のエージェント（人間かAIかを問わず）と協調し、互いの問題解決能力を補完し、タスク実行を並列化することに最適化されたエージェントの必要性を強く主張する。 [16] このような協調型AIエージェントを実現するには、現実世界の物理的な制約を伴うタスク（**身体性; embodiment**）と、人間間の主要なコミュニケーション手段である**自然言語**という、2つの大きな課題を克服しなければならない。 [17, 18, 19]

### 関連研究
- **AI研究ツールとしてのMinecraft:** Minecraftは、その広大でオープンエンドな世界、複雑なダイナミクス、そして報酬が疎であるという特性から、ワールドモデル、プランニング、単純な協調タスクの研究において、以前から研究者に人気のツールであった。 [61, 62] 本研究も同様の理由からMinecraftを採用している。 [63]
- **多エージェント・人間-AI協調プラットフォーム:** `Overcooked AI` [64]、`CerealBar` [65]、`GovSim` [65] といった既存の協調研究フレームワークに影響を受けつつ、MINDcraftは以下の点でそれらを拡張している。 [67]
    1. 料理に加え、クラフトや建設といったより多様なタスクを含む。
    2. 環境を自然言語で制御可能にする。
    3. エージェント間のピアツーピア（対等）およびリーダー/フォロワー（主従）の両方の相互作用を研究できる。
- **身体性AIと協調ロボティクス:** これまでの研究の多くは、`Habitat AI` [69, 70] などに見られるように、家庭の調理環境における単一エージェントのシナリオが中心であった。 [69]
- **LLMのための多エージェント手法:** `Teach` [72] や `Optima` [72] のようなフレームワークがリアルタイムの調整や効率の最適化を探求しており、プロンプティング手法 [73] やファインチューニング手法 [74] も提案されている。MINDcraftは、こうした手法を研究するための複雑な身体性環境を提供し、この分野の研究を促進することを目指している。 [75]

## 手法
### 概要
本研究では、LLMエージェントの協調的な身体性推論を研究・評価するために、以下の2つを提案している。

- **MINDcraft:** Minecraft環境内で、複数のLLMエージェントを動作させ、相互に対話させながらタスクを実行させるための、柔軟で拡張性の高いプラットフォーム。 [77, 78]
- **MineCollab:** MINDcraft上に構築された評価用ベンチマーク。協調が不可欠な「料理」「クラフト」「建設」の3つのドメインからなるタスクスイートを提供する。 [145, 146]

### 前提条件
- エージェントはMinecraftのシミュレーション環境内で動作する。 [8]
- エージェントの思考と行動決定は、外部のLLM APIを呼び出すことによって行われる。 [92, 100]
- エージェント間のコミュニケーションと調整は、主に自然言語を介して行われる。 [42]
- エージェントは環境の全てを一度に観測できるわけではなく、コマンドを実行して能動的に情報を得る必要がある（部分的観測可能性）。 [80]

### 詳細
#### MINDcraftプラットフォーム
MINDcraftは、エージェントの協調能力そのものを測定することに焦点を当てるため、エージェントの基本的な能力を最大限にサポートする設計になっている。 [122]

- **状態空間 (State Space):** エージェントは、周囲のブロック情報 (`!nearbyBlocks`) や現在作成可能なアイテム (`!craftable`) などを、特定のコマンドを能動的に呼び出す（ツールコール）ことで観測する。 [80, 81] これにより、不要な情報を削減し、LLMに与えるコンテキスト長を短縮している。 [104] 視覚入力も実験されたが、現在の視覚言語モデルは複雑な推論タスクの学習データが不足しているためか、テキストベースの詳細な観測の方が性能が良いことが確認されている。 [106, 107]

- **行動空間 (Action Space):** 従来の低レベルな行動（例：「ジャンプ」「見る」） [109] や、Javascriptコードを必要とする高レベルAPI (`Mineflayer`) [111] とは異なり、MINDcraftはLLMが直接呼び出せるように設計された**47の高レベルなパラメータ化されたツール**を提供する。 [113] 例えば、「"randy"というプレイヤーに"oak_log"を4つ渡す」という一連の複雑な手順は、`!givePlayer("randy", "oak_log", 4)` という単一のコマンドで実行できる。 [114, 115] これにより、LLMは低レベルな実装の詳細ではなく、高レベルなタスクの逐次的意思決定に集中できる。 [115] また、必要に応じてカスタムのJavascriptコードを生成・実行するツールもサポートしている。 [116]

- **エージェントアーキテクチャ:**
    - エージェントを管理するサーバー、メッセージを処理するメインループ、コマンドライブラリ、LLM呼び出しレイヤーの4つの主要コンポーネントで構成される。 [119]
    - 現在の対話内容と埋め込み（embedding）の類似度に基づいて、ツールの使用例（few-shot examples）を検索し、プロンプトに含めることでLLMの能力を向上させる、身体性を伴うRAG（Retrieval Augmented Generation）システムをサポートしている。 [124]

- **多エージェント協調の仕組み:**
    - エージェントは `startConversation` と `endConversation` コマンドを使い、自由に対話を開始・終了できる。 [127]
    - 一度に対話できるのは2エージェント間のみだが、このペアワイズ通信の仕組みを切り替えることで、3体以上のエージェント群にもスケールさせることができる。 [129]
    - エージェントがブロック設置などの環境内アクションを実行している間は、対話の速度が遅くなったり一時停止したりする。これにより、行動とコミュニケーションの同期が図られる。 [130, 131, 132]

#### MineCollab ベンチマーク
MineCollabは、現実世界のシナリオを反映し、長い手順（平均20ステップ以上）の行動計画、環境との効果的な相互作用、そしてリソースや時間の制約下での他エージェントとのコミュニケーションと調整を必要とするように設計されている。 [148]

- **タスクドメイン:**
    - **料理 (Cooking):** 複数の料理（例：ケーキとパン）を同時に作るタスク。 [151] エージェントは材料集めを分担し、調理器具を共有する必要がある。 [151] 特に「**ヘルズキッチン**」バリアントでは、各エージェントは自分が作るべきではない料理のレシピしか与えられず、他のエージェントにレシピを尋ねるという、より高度なコミュニケーションが強制される。 [162]
    - **クラフト (Crafting):** 家具や道具（例：本棚）を組み立てるタスク。 [166] エージェントは互いの所持品を伝え合い、必要な場合はレシピを共有し、材料を交換してタスクを完了させる必要がある。 [168, 169, 170]
    - **建設 (Construction):** 手順生成された設計図に基づいて建造物を建てるタスク。 [173] 各エージェントには、設計図全体を完成させるには不十分な特定の種類の材料（例：石材担当と木材担当）が与えられ、協調が不可欠となる。 [177, 178]

### 評価方法
- **データセット作成:** `llama3.3-70b-instruct` をオラクルエージェントとして使用し、各タスクで試行を重ね、成功した試行のログをデータセットとして収集した。 [193] 例えば、料理とクラフトでは成功した試行のみ、建設ではスコア上位25%の試行をフィルタリングして高品質なデータを確保している。 [194]
- **SFT (Supervised Fine-Tuning):** 上記で作成したデータセットを用いて、より小規模なモデル (`llama3-8b-instruct`) をファインチューニングし、性能向上を実証する。 [185]
- **評価指標:**
    - 料理とクラフト: タスクの最終的な成功/失敗（バイナリ、0か1）。 [887]
    - 建設: 完成した建造物と設計図との間の**編集距離**に基づくスコア（完成度が高いほど高スコア）。 [179, 887]
- **実験設計:** タスクの複雑性を以下の2つの軸で変化させ、エージェントの性能を評価する。
    1.  **身体性推論の複雑性:** 建設タスクにおいて、使用する材料の種類や部屋の数を増やす。 [201]
    2.  **協調の複雑性:** 料理・クラフトタスクにおいて、参加するエージェントの数を2体から5体に増やす。 [209] また、レシピ情報を隠す（ヘルズキッチンなど）ことで、コミュニケーションの必要性を高める。 [284]

## 結果と結論
### 概要
実験の結果、Claude 3.5 Sonnetのような最先端の大規模言語モデル（LLM）でさえ、身体性を伴う協調タスク、特に建設タスクにおいては苦戦し、エージェント数が増加するにつれて性能が低下することが明らかになった。 [49] この性能低下の主な原因は、エージェント間の効率的な自然言語コミュニケーションがボトルネックとなっていることである。 [50] 既存のLLMは、このような協調シナリオに最適化されていないことが示唆された。 [11]

### 詳細
- **身体性タスクの複雑性の影響:**
    - 建設タスクにおいて、設計図が複雑になる（例：必要な材料の種類や部屋の数が増える）と、ほとんどのモデルで性能が低下した (Figure 3e, 3f)。 [205]
    - 定性的な分析からは、エージェントが記憶すべき情報が増えるにつれて、他のエージェントが完了した作業を破壊してしまうような非効率な行動が頻繁に観察された。 [207, 208]

- **協調の複雑性の影響:**
    - 料理とクラフトのタスクにおいて、エージェントの数を2体から5体に増やすと、テストした全てのLLMで成功率が劇的に低下した（例：最大90%から30%未満へ）(Figure 3a, 3b)。 [211]
    - タスクは並列化可能なため、理論上はエージェントが増えれば成功率は向上するはずだが、実際には調整（coordination）にかかる負荷が大幅に増加し、冗長な作業やリソースの競合といった問題が発生した。 [210, 212, 213]

- **コミュニケーションの重要性の証明:**
    - 料理の「ヘルズキッチン」や、クラフトでレシピ情報を隠したタスクのように、エージェント間で詳細なステップバイステップの計画を**言語で伝えることを強制**した場合、全てのモデルでタスク成功率が**15%以上低下**した (Figure 3c, 3d)。 [51, 284]
    - これは、現在のLLMが、他のエージェントに計画を効果的に伝えたり、伝えられた計画を正確に実行したりすることに長けていないことを示している。 [287]

- **ファインチューニングの効果:**
    - `llama3-8b-instruct` という比較的小規模なモデルを、本研究で生成したSFTデータセットでファインチューニングしたところ、性能が大幅に向上した。 [195]
    - ファインチューニング後の `llama3-8b-sft` は、クラフトタスクにおいて `gpt-4o` や `llama3.3-70b-instruct` といったより大規模なモデルを上回る性能を示し、小規模モデルでもデータ次第で高い協調能力を獲得できる可能性が示された。 [195, 192]

## 先行研究との差分
### 手法面
- **プラットフォームの包括性:** Overcooked AI [301] や CerealBar [303] などの既存の協調研究プラットフォームと比較して、MINDcraftは以下の点でより包括的である（Table 1）。 [55]
    - **タスクの多様性:** 料理だけでなく、クラフトや建設といった多様な身体性タスクをサポートする。 [67]
    - **言語による制御:** 環境とのインタラクションを自然言語コマンドで行うことに主眼を置いている。 [67]
    - **部分的観測可能性:** エージェントは環境の一部しか観測できず、能動的な情報収集が必要であり、これは心の理論（Theory of Mind）の能力をテストするために不可欠である。 [57]
    - **定量的評価:** 先行研究では定性的評価が主であった協調能力を、明確な指標で定量的に評価できる。 [59]
- **行動空間の抽象化レベル:** MineRL [357] のような低レベルな行動空間や、Mineflayer API [360] のようなプログラマティックな行動空間に対し、MINDcraftはLLMが直接解釈・生成しやすい高レベルな意味的コマンド（例: `!givePlayer`）を提供することで、行動の抽象化レベルを最適化し、LLMが高次の推論に集中できるようにしている。 [113, 115]

### 結果面
- **コミュニケーションのボトルネックの定量的特定:** 先行研究でも多エージェントシステムの課題は指摘されていたが、本研究は「詳細な計画の伝達を強制する」という具体的な条件下で**性能が15%以上低下する**ことを定量的に示し、自然言語コミュニケーションが協調における主要なボトルネックであることを明確に特定した。 [10, 51]
- **エージェント数増加に伴う性能低下の体系的分析:** タスクが並列化可能であるにも関わらず、エージェント数を増やすと性能が一貫して低下することを複数のLLMで体系的に示し、調整コストの増大が個々のエージェントの作業効率向上を上回ることを実証した。 [211]

## 議論
- **既存LLMの協調能力の限界:** 本研究の結果は、現在の最先端LLMエージェントでさえ、多エージェントが協調するタスク、特に身体性を伴う複雑なシナリオにおいては、能力が不十分であることを浮き彫りにした。 [294, 11]
- **コミュニケーションは最大の障壁:** エージェントの性能低下の根本原因は、効率的な自然言語コミュニケーション能力の欠如にある。 [50] 特に、他のエージェントに複雑な計画を伝えたり、その計画を理解して実行したりする能力に課題がある。 [287] この発見は、今後の協調型AIの研究開発において、コミュニケーション能力の向上が最優先課題の一つであることを示唆している。
- **スケーラビリティの問題:** エージェントの数を増やすと、理論的な利点（作業の並列化）にもかかわらず、実際には調整のオーバーヘッドが増大し、全体のパフォーマンスが低下するという「スケーラビリティの壁」が存在することが示された。 [211, 212]
- **学習手法への示唆:** プロンプティングや、本研究でも有効性を示した教師ありファインチューニング（SFT）だけでは、真の協調能力を獲得するには限界がある可能性がある。 [52, 11] 今後は、エージェント間のインタラクションを通じて学習を洗練させていくような、より高度な手法（例：マルチエージェント強化学習など）の研究が求められる。
- **将来の展望:** 本研究で開発されたMINDcraftとMineCollabは、本論文で扱ったタスク以外にも、エージェントの創造性を評価する自由な建築タスク [138]、社会や文化の形成をシミュレートする研究 [140]、視覚情報を取り入れたマルチモーダルな推論タスク [141] など、協調型身体性AIに関する多様な研究を促進するプラットフォームとしての可能性を秘めている。 [137]